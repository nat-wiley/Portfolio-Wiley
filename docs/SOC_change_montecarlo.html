<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Natalie Wiley - Soil Organic Carbon Stock Change</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Natalie Wiley</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ghg-inventory-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">GHG Inventory Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ghg-inventory-projects">    
        <li>
    <a class="dropdown-item" href="./Risk_Assessment.html">
 <span class="dropdown-text">Risk Analysis for Transportation Emission Reduction Policies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Electricity_emissions.html">
 <span class="dropdown-text">GA Electricity Emissions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Transportation_Emissions.html">
 <span class="dropdown-text">Transportation Emissions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Emission_Factors.html">
 <span class="dropdown-text">Custom Soil Emission Factors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Datagaps.html">
 <span class="dropdown-text">Addressing Data Gaps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Urea_Emissions.html">
 <span class="dropdown-text">Urea Emissions Estimation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SOC_change_montecarlo.html">
 <span class="dropdown-text">Soil Organic Carbon Stock Change</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./N2O_SoilEmissions.html">
 <span class="dropdown-text">Soil N2O Emissions-Regression Model</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./Geospatial.html">
 <span class="menu-text">Geospatial Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./COB_report.html">
 <span class="menu-text">Sustainability Assessments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Bison_storymap.html">
 <span class="menu-text">COP27 Presentation</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Soil Organic Carbon Stock Change</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This R Script estimates the change in soil organic carbon stock in cropland soils between 2005 and 2010. This function uses a Monte Carlo analysis methods from the 2006 IPCC guidelines. This estimation looks at the carbon stock changes among different crop management types such as full and no till including levels of C input.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="st">"SOC.stockdif"</span><span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">crop.expert.data=</span><span class="st">"expertdata.csv"</span>, <span class="at">land.use.beta=</span><span class="st">"cult </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="st">                         .betas.csv"</span>, <span class="at">land.use.cov=</span><span class="st">"LandUseCov.csv"</span>, <span class="at">mgmtbeta=</span><span class="st">"mgmt</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">                         .betas.csv"</span>, <span class="at">mgmtcov=</span> <span class="st">"MgmtCov.csv"</span>, <span class="at">C.input.beta=</span><span class="st">"input</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">                         .betas.csv"</span>, <span class="at">C.input.cov=</span><span class="st">"CinputCov.csv"</span>, <span class="at">x.variables=</span><span class="st">"x</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">                         .variables.csv"</span>, <span class="at">SOC.ref=</span><span class="dv">80</span>, <span class="at">SOC.ref.sd=</span><span class="dv">36</span>, cropland.area</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                         <span class="ot">=</span><span class="dv">56890</span>,<span class="at">cropland.area.sd=</span><span class="dv">2845</span>, <span class="at">D =</span> <span class="dv">20</span>, <span class="at">nreps =</span> <span class="dv">10</span>, iseed</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                         <span class="ot">=</span><span class="dv">1234</span>, <span class="at">ncases =</span> <span class="dv">6</span>,  <span class="at">EF.ft=</span><span class="dv">1</span>, <span class="at">EF.med.input =</span> <span class="dv">1</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nmitscenarios=</span><span class="dv">1</span>, <span class="at">return.option=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is commented code to serve as descriptors for data types used within the function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Script developed by N Wiley</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Originally Developed: September 27, 2022</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Last Update: October 20, 2022 </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Script estimates the SOC stock change different in cropland soils between 2005 and 2020, also showing SOC changes w/</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">#different management types (full till, no till,) and level of input (low, med, high)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">####### Arguments</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># crop.expert.data      Input file in csv format with data given in proportions of land within defined management cases</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># iseed                 Initial seed value for random draws</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># nreps                 Number of Monte Carlo iterations</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ncases                Number of Management cases from the expert data</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># beta                  Parameter from lME model used to derive emission factors</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cov.matrix            Matrix with covariance from LME model used to derive emission factors</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># D                     Stock change dependence (years) (20 comes from IPCC guidelines VOL 4 ch 2)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># SOC.ref                Reference soil carbon stock</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># SOC.ref.sd             Error associated with soil carbon stock</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># cropland.area                  Land area (hectares)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># cropland.area.sd               Error associated with area</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># return.option         </span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#___________ Begin Script ___________</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>{  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set Seed</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(iseed)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load Library</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#___________ Import Data ____________</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  expert.data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>crop.expert.data, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Import Betas for EF's</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  landuse.beta<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>land.use.beta, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#landuse.beta&lt;-c(landuse.beta[1,])</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  LU.beta<span class="ot">&lt;-</span><span class="fu">as.vector</span>(landuse.beta)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#landuse.beta&lt;-c(land.use.beta[,1])</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  mgmt.beta<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>mgmtbeta, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span> )</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mgmt.beta&lt;-c(mgmtbeta[,1])</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  Cinput.beta<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>C.input.beta, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Cinput.beta&lt;-c(C.input.beta[,1])</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  landuse.cov<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>landuse.cov, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  mgmt.cov<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>mgmtcov, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  Cinput.cov<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>Cinput.cov, <span class="at">header=</span>F, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  x.variables<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span>x.variables, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>, <span class="at">fill=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#______________ Create Checks ________________</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check that cropland area and uncertainty is greater than 0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  check.cropland.area<span class="ot">&lt;-</span>cropland.area<span class="sc">&gt;=</span><span class="dv">0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>check.cropland.area) {<span class="fu">stop</span>(<span class="st">"Cropland area is not greater than 0."</span>)}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  check.cropland.area.sd<span class="ot">&lt;-</span>cropland.area.sd<span class="sc">&gt;=</span><span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>check.cropland.area.sd) {<span class="fu">stop</span>(<span class="st">"Cropland area standard deviation is not greater than 0."</span>)}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check that SOC.ref and uncertainty is greater than 0</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  check.SOC.ref<span class="ot">&lt;-</span>SOC.ref<span class="sc">&gt;=</span><span class="dv">0</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>check.SOC.ref) {<span class="fu">stop</span>(<span class="st">"SOC reference stock is not greater than 0."</span>)}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  check.SOC.ref.sd<span class="ot">&lt;-</span>SOC.ref.sd<span class="sc">&gt;=</span><span class="dv">0</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>check.SOC.ref.sd) {<span class="fu">stop</span>(<span class="st">"SOC reference stock standard deviation is not greater than 0."</span>)}</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check that proportion amounts equal 1 in each year for each expert</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#______________ Probabilistic draws for Monte Carlo Simulation_______________</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate nreps for SOC.ref</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  SOC.ref.sim<span class="ot">&lt;-</span><span class="fu">rnorm</span>(nreps, <span class="at">mean =</span> SOC.ref, <span class="at">sd=</span>SOC.ref.sd)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  SOC.ref.sim&lt;-as.matrix(t(SOC.ref.sim))</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate nreps for cropland.area</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  area.sim<span class="ot">&lt;-</span><span class="fu">rnorm</span>(nreps, <span class="at">mean =</span> cropland.area, <span class="at">sd=</span>cropland.area.sd)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a> <span class="co"># area.sim&lt;-as.matrix(area.sim)</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw samples from expert proportions (expert.data)</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#expert.sim&lt;-matrix(0,ncol = nreps, nrow = 12)</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  expert.sim<span class="ot">&lt;-</span>expert.data[<span class="fu">sample</span>(<span class="fu">ncol</span>(expert.data), <span class="at">size =</span> nreps, <span class="at">replace =</span> <span class="cn">TRUE</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#______________ Estimate Area _____________</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  area.prop.comb<span class="ot">&lt;-</span><span class="fu">sweep</span>(expert.sim, <span class="at">MARGIN=</span><span class="dv">2</span>, area.sim, <span class="st">'*'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#These parameters come from the previous LME models to create EF betas and covariances</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine number of parameters for each EF</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  numpar.landuse<span class="ot">&lt;-</span><span class="fu">length</span>(landuse.beta)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  numpar.mgmt<span class="ot">&lt;-</span><span class="fu">length</span>(mgmt.beta)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  numpar.Cinput<span class="ot">&lt;-</span><span class="fu">length</span>(Cinput.beta)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Cholesky decomposition for each EF</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  chol.decomp.landuse<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">chol</span>(landuse.cov))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  chol.decomp.mgmt<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">chol</span>(mgmt.cov))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  chol.decomp.Cinput<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">chol</span>(Cinput.cov))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random draws of 0 for each EF in a normal distribution</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  random.landuse<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(nreps<span class="sc">*</span>numpar.landuse),numpar.landuse,nreps)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  random.mgmt<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(nreps<span class="sc">*</span>numpar.mgmt),numpar.mgmt,nreps)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  random.Cinput<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(nreps<span class="sc">*</span>numpar.Cinput),numpar.Cinput,nreps) </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulated betas</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  landuse.EF.beta.sim.intermediatecalc<span class="ot">&lt;-</span>(chol.decomp.landuse<span class="sc">%*%</span>random.landuse)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  landuse.EFbeta.sim<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span>nreps)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    landuse.EFbeta.sim[,e]<span class="ot">&lt;-</span> ((landuse.EF.beta.sim.intermediatecalc[,e]<span class="sc">+</span>landuse.beta[,e]))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  mgmt.EF.beta.sim<span class="ot">&lt;-</span>(chol.decomp.mgmt<span class="sc">%*%</span>random.mgmt)<span class="sc">+</span>mgmt.beta</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  Cinput.EF.beta.sim<span class="ot">&lt;-</span>(chol.decomp.Cinput<span class="sc">%*%</span>random.Cinput)<span class="sc">+</span>Cinput.beta</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># __________ Estimate Emission Factors __________ (EF = intercept + B1X1) --&gt; put x.cult in model (create csv and import) - then check to make sure that EF reps fit within the CI</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predictor variables from Assignment 2</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only need wet factors, not dry, because soils are in only a wet climate (don't use dry factors!)</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  x.landuse<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x.variables[,<span class="dv">1</span>])</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  x.landuse<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x.landuse)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  x.rt.wet<span class="ot">&lt;-</span><span class="fu">as.vector</span>(x.variables[,<span class="dv">2</span>])</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  x.rt.wet<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x.rt.wet)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  x.nt.wet<span class="ot">&lt;-</span><span class="fu">as.vector</span>(x.variables[,<span class="dv">3</span>])</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  x.nt.wet<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x.nt.wet)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  x.low<span class="ot">&lt;-</span><span class="fu">as.vector</span>(x.variables[,<span class="dv">4</span>])</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  x.low<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x.low)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  x.high<span class="ot">&lt;-</span><span class="fu">as.vector</span>(x.variables[,<span class="dv">5</span>])</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  x.high<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x.high)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Land use EF reps</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The sweep function multiples the beta sim with the predictor variables to get the components of the EF</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a> <span class="co"># EF.landuse.sweep&lt;-sweep(landuse.EFbeta.sim, 1, x.landuse, "*")</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#EF.landuse&lt;-apply(EF.landuse.sweep, MARGIN = 1, FUN = sum)</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a> <span class="co"># EF.landuse&lt;-as.matrix(t(EF.landuse))</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>EF.landuse<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>numpar.landuse, <span class="at">ncol=</span>nreps)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  EF.landuse[,e]<span class="ot">&lt;-</span>(landuse.EFbeta.sim[e,]<span class="sc">*</span>x.landuse)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Management EF reps</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  EF.rt.wet.sweep<span class="ot">&lt;-</span><span class="fu">sweep</span>(mgmt.EF.beta.sim, <span class="dv">1</span>, x.rt.wet, <span class="st">"*"</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  EF.rt.wet<span class="ot">&lt;-</span><span class="fu">apply</span>(EF.rt.wet.sweep, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  EF.rt.wet<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">t</span>(EF.rt.wet))</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  EF.nt.wet.sweep<span class="ot">&lt;-</span><span class="fu">sweep</span>(mgmt.EF.beta.sim, <span class="dv">1</span>, x.nt.wet, <span class="st">"*"</span>)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  EF.nt.wet<span class="ot">&lt;-</span><span class="fu">apply</span>(EF.nt.wet.sweep, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  EF.nt.wet<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">t</span>(EF.nt.wet))</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CInput EF reps</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  EF.low.sweep<span class="ot">&lt;-</span><span class="fu">sweep</span>(Cinput.EF.beta.sim, <span class="dv">1</span>, x.low, <span class="st">"*"</span>)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  EF.low<span class="ot">&lt;-</span><span class="fu">apply</span>(EF.low.sweep, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>  EF.low<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">t</span>(EF.low))</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>  EF.high.sweep<span class="ot">&lt;-</span><span class="fu">sweep</span>(Cinput.EF.beta.sim, <span class="dv">1</span>, x.high, <span class="st">"*"</span>)</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>  EF.high<span class="ot">&lt;-</span><span class="fu">apply</span>(EF.high.sweep, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>  EF.high<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">t</span>(EF.high))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#______________ Probabilistic Results _______________</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SOC stock changes by case</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 1: low input, full till</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  SOC.low.ft<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    SOC.low.ft[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.low[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">7</span>,r])<span class="sc">-</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                       (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.low[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">1</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 2: low input, no till  </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  SOC.low.nt<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    SOC.low.nt[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.low[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">8</span>,r])<span class="sc">-</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                       (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.low[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">2</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 3: medium input, full till </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  SOC.med.ft<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    SOC.med.ft[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.med.input<span class="sc">*</span>area.prop.comb[<span class="dv">9</span>,r])<span class="sc">-</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                       (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.med.input<span class="sc">*</span>area.prop.comb[<span class="dv">3</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 4: medium input, no till</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  SOC.med.nt<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    SOC.med.nt[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.med.input<span class="sc">*</span>area.prop.comb[<span class="dv">10</span>,r])<span class="sc">-</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                       (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.med.input<span class="sc">*</span>area.prop.comb[<span class="dv">4</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 5: high input, full till    </span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  SOC.high.ft<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    SOC.high.ft[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.high[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">11</span>,r])<span class="sc">-</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                        (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.ft<span class="sc">*</span>EF.high[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">5</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  }   </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Case 6: high input, no till</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  SOC.high.nt<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> nreps)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    SOC.high.nt[,r]<span class="ot">&lt;-</span>((SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.high[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">12</span>,r])<span class="sc">-</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                        (SOC.ref.sim[,r]<span class="sc">*</span>EF.landuse[,r]<span class="sc">*</span>EF.nt.wet[,r]<span class="sc">*</span>EF.high[,r]<span class="sc">*</span>area.prop.comb[<span class="dv">6</span>,r]))<span class="sc">/</span>D</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  }   </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create results matrix</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  C.stockdif.total<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> nreps)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>nreps)) {</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    C.stockdif.total[,r]<span class="ot">&lt;-</span>SOC.low.ft[,r]<span class="sc">+</span>SOC.low.nt[,r]<span class="sc">+</span>SOC.med.ft[,r]<span class="sc">+</span>SOC.med.nt[,r]<span class="sc">+</span>SOC.high.ft[,r]<span class="sc">+</span>SOC.high.nt[,r]</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#___________ Estimate means and confidence intervals of C stock change 2005-2020 ________</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create matrix with col 1 = median, col 2 = 2.5 percentile, and col 3 = 97.5 percentile</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  C.stockdif.results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  C.stockdif.results[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(C.stockdif.total)</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  q<span class="ot">&lt;-</span><span class="fu">quantile</span>(C.stockdif.total, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  C.stockdif.results[,<span class="dv">2</span>]<span class="ot">&lt;-</span>q[<span class="dv">1</span>]</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  C.stockdif.results[,<span class="dv">3</span>]<span class="ot">&lt;-</span>q[<span class="dv">2</span>]</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">#___________ Return Statements ____________</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(return.option <span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"Island X mean C stock change in mineral cropland soils (C tonnes /yr)"</span><span class="ot">=</span>C.stockdif.results[,<span class="dv">1</span>],</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2.5 percentile C stock change"</span><span class="ot">=</span>C.stockdif.results[,<span class="dv">2</span>], <span class="st">"97.5 percentile C stock change"</span><span class="ot">=</span>C.stockdif.results[,<span class="dv">3</span>]))</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(return.option <span class="sc">==</span><span class="dv">2</span>) {</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">hist</span>(<span class="at">x=</span>C.stockdif.total, <span class="at">col =</span> <span class="st">"blue3"</span>, <span class="at">main =</span> <span class="st">"Simulated SOC change for all replicates from Monte Carlo Simulation"</span>, </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">"SOC change replicates (C tonnes/yr)"</span>, <span class="at">xlim=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50000</span>,<span class="dv">100000</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#____________ End Script ________________</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>